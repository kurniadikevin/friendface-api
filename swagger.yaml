openapi: 3.0.3
info:
  title: Friendface-API v1
  version: 0.1.0
  description: |-
    This API is used for [Friendface](https://friendface.vercel.app/) social media project with use case of doing CRUD to database and store image file. 

    The API handle some social media schema including post, comment, like, user, userChat, messages, notification, messages notification, and chat room.
    
    In general the data have two different category. One for social media posting format and the other is of the messager feature.
    
    _Some related link:_
    - [Friendface-client repository](https://github.com/kurniadikevin/friendface-client)
    - [Friendface App](https://friendface.vercel.app/)
    - [Developer](https://github.com/kurniadikevin)
    
 

servers:
  - url: http://localhost:5000
tags:
  - name: posts
    description: Operation for posts route
    
  - name: users
    description: Operation for users route
    
  - name: comments
    description: Operations for comments route

  - name : userChat
    description: Operations about userChat for messager 

  - name : chatRoom
    description: Operations about chatRoom for messager 

  - name : message
    description: Operations about userChat for messager 

paths:
  /posts:
    get:
      tags:
        - posts
      summary: Get all post
      description: Get all post data on one endpoint
      operationId: getAllPosts
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema: 
                type: array       
        '400':
          description: Invalid 

  /posts/page/{pageNumber}:
    get:
      tags:
        - posts
      summary: Get all post
      description: Get all post data on page format per 10 posts
      operationId: getAllPostsWithPage
      parameters:
        - name: pageNumber
          in: path
          description: page number of post
          required: true
          schema:
            type: integer
            format: int64
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema: 
                type: array
                
        '400':
          description: Invalid 

  /posts/postDetail/{postId}/page/1:
    get:
      tags:
        - posts
      summary: Get post detail
      description: Get specific post detail
      operationId: getPostDetail
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema: 
                type: array       
        '400':
          description: Invalid 
      parameters:
        - name: postId
          in: path
          description: postId of the post needed
          required: true
          schema:
            type: string

  /posts/friends/{userId}:
      get:
        tags:
          - posts
        summary: Get post for friends of specific user
        description: Get friend post by user with userId
        operationId: getPostFriends
        responses:
          '200':
            description: Successful operation
            content:
              application/json:
                schema: 
                  type: array       
          '400':
            description: Invalid 
        parameters:
          - name: userId
            in: path
            description: userId of user you want to find friends post of
            required: true
            schema:
              type: string

  /posts/friends/{userId}/page/{pageNumber}:
      get:
        tags:
          - posts
        summary: Get post for friends of specific user with paganation
        description: Get friend post by user with userId with paganation
        operationId: getPostFriendsPages
        responses:
          '200':
            description: Successful operation
            content:
              application/json:
                schema: 
                  type: array       
          '400':
            description: Invalid 
        parameters:
          - name: userId
            in: path
            description: userId of user you want to find friends post of
            required: true
            schema:
              type: string

          - name: pageNumber
            in: path
            description: page number of post query
            required: true
            schema:
              type: integer
              format: int64

  /posts/{userId}:
      get:
        tags:
          - posts
        summary: Get user post
        description: Get post than the author id is userId
        operationId: getPostFriends
        responses:
          '200':
            description: Successful operation
            content:
              application/json:
                schema: 
                  type: array       
          '400':
            description: Invalid 
        parameters:
          - name: userId
            in: path
            description: userId of user you want to find post 
            required: true
            schema:
              type: string  

  /posts/byUser/{userId}/page/{pageNumber}:
      get:
        tags:
          - posts
        summary: Get post specific user with paganation
        description: Get post by user with userId with paganation
        operationId: getPostUserPages
        responses:
          '200':
            description: Successful operation
            content:
              application/json:
                schema: 
                  type: array       
          '400':
            description: Invalid 
        parameters:
          - name: userId
            in: path
            description: userId of user you want to find friends post of
            required: true
            schema:
              type: string

          - name: pageNumber
            in: path
            description: page number of post query
            required: true
            schema:
              type: integer
              format: int64

  /posts/{userId}/count:
      get:
        tags:
          - posts
        summary: Get user post count
        description: Get post than the author id is userId total post
        operationId: getPostFriendsCount
        responses:
          '200':
            description: Successful operation
            content:
              application/json:
                schema: 
                  type: array       
          '400':
            description: Invalid 
        parameters:
          - name: userId
            in: path
            description: userId of user you want to find post 
            required: true
            schema:
              type: string  

  /posts/newpost:
    post:
      tags:
        - posts
      summary: Make new post
      description: Make new post with input of user data and post data 
      operationId: postNewPost
      requestBody:
        description: Create a new post with text and authorId on author
        content:
          application/json:
             schema:
                type: object
                properties:
                  text:
                    type: string
                  author:
                    type: string
        required: true
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
             schema:
                type: object
                properties:
                  text:
                    type: string
                    example: Hello world 
                  author:
                    type: string 
                    example: (insert author id)  
        '400':
          description: Invalid 

  /posts/delete/{postId}:
      post:
        tags:
          - posts
        summary: Delete post by Id
        description: Delete specific post using postId
        operationId: deletePostById
        responses:
          '200':
            description: Post sucessfully deleted
            content:
              application/json:
                schema: 
                  type: array       
          '400':
            description: Error delete
        parameters:
          - name: postId
            in: path
            description: postId of post you want to delete 
            required: true
            schema:
              type: string  

  /posts/likes/{postId}:
      post:
        tags:
          - posts
        summary: Like post by Id
        description: Like specific post using postId
        operationId: LikePostById
        requestBody:
        content:
          application/json:
             schema:
                type: object
                properties:
                  userId:
                    type: string
        responses:
          '200':
            description: Post sucessfully liked
            content:
              application/json:
                schema: 
                  type: array       
          '400':
            description: Error delete
        parameters:
          - name: postId
            in: path
            description: postId of post you want to liked
            required: true
            schema:
              type: string  

  /users:
    get:
      tags:
        - users
      summary: Get all user data
      description: Get all post data on one endpoint
      operationId: getAllUsers
      responses:
        '200':
          description: Successful operation
          content:
            application/json:
              schema: 
                type: array
                items:
                  $ref: '#/components/schemas/Users'       
        '400':
          description: Invalid 




components:
  schemas:
    Posts:
      required:
        - text
        - author
      type: object
      properties:
        _id:
          type: string
          example: 6374e91e5ffbe2e45ddf4045
        text:
          type: string
          example: Hello world
        author:
           $ref: '#/components/schemas/Users'
        date:
          type: string
          format: date-time
          example: '2022-11-05T06:47:02.421+00:00'
        likes:
          type: array
          example: [postId : '6374e91e5ffbe2e45ddf4045', byUser : "6367b17ab6704e28258dddf4",action : 'Liked',date : '2022-11-05T06:47:02.421+00:00' ]
        comment:
           $ref: '#/components/schemas/Comment'
        imageContent:
          type: string
          description: link to image content

    Users:
      required:
        - email
        - password
      type: object
      properties:
        _id:
          type: string
          example: 6374e91e5ffbe2e45ddf4045
        username:
          type: string
          example: TestAccount
        email:
          type: string
          example: guest@gmail.com
        password:
          type: string
          example: 123456
        friends:
          type: array
          example: [{_id: "6374e91e5ffbe2e45ddf4045", email: "guest@gmail.com", username: "TestAccount",…}]
        profilePicture:
          type: string
          description: url for profile picture
        friendRequest:
          type: array
          example: [{ seenAt: '1681281189976', sender: {_id: "6414298aa9d5395dc8c79c6a"},status: "pending"}]
        postNotification:
          type: array
          example: [{action: "Liked", byUser : {_id: "6367b17ab6704e28258dddf4"}, postId : "6419ab32b8a9bb03162c3968", seenAt: '1681306103830'}]

    Comment:
      type: object
      properties:
        _id:
          type: string
          example: 6374e91e5ffbe2e45ddf4045
        text:
          type: string
          example: Hello world
        author:
           $ref: '#/components/schemas/Users'
        date:
          type: string
          format: date-time
          example: '2022-11-05T06:47:02.421+00:00'
        likes:
          type: array
          example: [postId : '6374e91e5ffbe2e45ddf4045', byUser : "6367b17ab6704e28258dddf4",action : 'Liked',date : '2022-11-05T06:47:02.421+00:00' ]
        comment:
          type: array
    
    UserChat:
       type: object
       properties:
        _id:
          type: string
          example: 642d6378863dd8b88a7b29b5
        userId:
           $ref: '#/components/schemas/Users'
        chatRoomList:
          type: array
          items:
             $ref: '#/components/schemas/ChatRoom'
        messageNotification:
          type: array
          example: [{chatRoomId: 642fb986102f4e8633f2b32d,authorId: 6374e91e5ffbe2e45ddf4045}]
    
    ChatRoom:
      type: object
      properties:
        _id:
          type: string
          example: 642c2c593abefd2cfd40152e
        membersId:
          type: array
          example: [641c56365cb3f5c766ebbb4b,6374e91e5ffbe2e45ddf4045]
          description: array containing of usersId can be contain more than 2 on grop chat and 2 on private chat
        createdAt:
          type: string
          format: date-time
          example: '2022-11-05T06:47:02.421+00:00'
          description: default value is date now (date when chatroom created)
        modifiedAt:
          type: string
          format: date-time
          example: '2022-11-05T06:47:02.421+00:00'
        messagesId:
          type: array
          items:
            $ref: '#/components/schemas/Messages'
        groupName:
          type: string
          example: Whitelist group

    Message:
      type: object
      properties:
        _id:
          type: string
          example: 64243a73730d4246b6bab4ac
        author:
           $ref: '#/components/schemas/Users'
        text:
          type: string
          example: Good morning world
        mediaContentUrl:
          type: string
          description: url of file for media on messages
        chatRoomId:
          $ref: '#/components/schemas/ChatRoom'
        sendAt:
          type: string
          format: date-time
          example: '2022-11-05T06:47:02.421+00:00'
          description: default value is the time of data created
        readAt:
          type: string
          format: date-time
          example: '2022-11-05T06:47:02.421+00:00'